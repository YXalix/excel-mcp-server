# Excel MCP Server è°ƒç”¨æŒ‡å—

æœ¬æ–‡æ¡£è¯¦ç»†è¯´æ˜å¦‚ä½•æ­£ç¡®è°ƒç”¨ Excel MCP Server çš„å·¥å…·ï¼ŒåŒ…æ‹¬ Python å’Œ curl ä¸¤ç§å®ç°æ–¹å¼ã€‚

## ğŸ” é—®é¢˜åˆ†æ

åŸå§‹çš„ curl å‘½ä»¤æ— æ³•æ­£å¸¸å·¥ä½œï¼ŒåŸå› æ˜¯ï¼š

1. **ç¼ºå°‘æ­£ç¡®çš„ MCP åè®®æµç¨‹**ï¼šéœ€è¦å…ˆåˆå§‹åŒ–ä¼šè¯å¹¶è·å– session ID
2. **ç¼ºå°‘ JSON-RPC æ ¼å¼**ï¼šå·¥å…·è°ƒç”¨å¿…é¡»ä½¿ç”¨æ ‡å‡†çš„ JSON-RPC 2.0 æ ¼å¼
3. **ç¼ºå°‘ä¼šè¯ç®¡ç†**ï¼šéœ€è¦åœ¨åç»­è¯·æ±‚ä¸­æºå¸¦ session ID

## ğŸ“ æ­£ç¡®çš„è°ƒç”¨æµç¨‹

### ç¬¬ä¸€æ­¥ï¼šåˆå§‹åŒ–ä¼šè¯

```bash
curl -X POST http://localhost:8000/mcp \
  -H "Content-Type: application/json" \
  -H "Accept: application/json,text/event-stream" \
  -D /tmp/headers.txt \
  -d '{
    "jsonrpc": "2.0",
    "id": 1,
    "method": "initialize",
    "params": {
      "protocolVersion": "2024-11-05",
      "capabilities": {
        "roots": {"listChanged": true},
        "sampling": {}
      },
      "clientInfo": {
        "name": "curl-client",
        "version": "1.0.0"
      }
    }
  }'
```

**é‡è¦**ï¼šä»å“åº”å¤´ä¸­æå– `mcp-session-id`ï¼š

```bash
SESSION_ID=$(grep -i "mcp-session-id:" /tmp/headers.txt | cut -d' ' -f2 | tr -d '\r\n')
```

### ç¬¬äºŒæ­¥ï¼šå‘é€åˆå§‹åŒ–å®Œæˆé€šçŸ¥

```bash
curl -X POST http://localhost:8000/mcp \
  -H "Content-Type: application/json" \
  -H "Accept: application/json,text/event-stream" \
  -H "mcp-session-id: $SESSION_ID" \
  -d '{
    "jsonrpc": "2.0",
    "method": "notifications/initialized"
  }'
```

### ç¬¬ä¸‰æ­¥ï¼šè°ƒç”¨å·¥å…·

```bash
curl -X POST http://localhost:8000/mcp \
  -H "Content-Type: application/json" \
  -H "Accept: application/json,text/event-stream" \
  -H "mcp-session-id: $SESSION_ID" \
  -d '{
    "jsonrpc": "2.0",
    "id": 3,
    "method": "tools/call",
    "params": {
      "name": "read_data_from_excel",
      "arguments": {
        "filepath": "/Users/nashzhou/code/openhands/excel-mcp-server/small.xlsx",
        "sheet_name": "Sheet",
        "start_cell": "A1"
      }
    }
  }'
```

## ğŸ Python å®ç°

æˆ‘ä»¬æä¾›äº†ä¸€ä¸ªå®Œæ•´çš„ Python å®¢æˆ·ç«¯ç±» `ExcelMCPClient`ï¼Œå®ƒå°è£…äº†æ‰€æœ‰å¿…è¦çš„åè®®ç»†èŠ‚ï¼š

```python
from excel_mcp_client import ExcelMCPClient

# åˆ›å»ºå®¢æˆ·ç«¯å¹¶è¿æ¥
client = ExcelMCPClient()
if client.connect():
    # è¯»å– Excel æ•°æ®
    data = client.read_excel_data(
        filepath="/path/to/your/file.xlsx",
        sheet_name="Sheet1",
        start_cell="A1"
    )
    print(data)
```

### ä¸»è¦ç‰¹æ€§

- âœ… è‡ªåŠ¨å¤„ç†ä¼šè¯ç®¡ç†
- âœ… æ”¯æŒæ‰€æœ‰ Excel MCP å·¥å…·
- âœ… é”™è¯¯å¤„ç†å’Œé‡è¯•é€»è¾‘
- âœ… ç±»å‹æç¤ºå’Œæ–‡æ¡£
- âœ… ä¾¿æ·æ–¹æ³•å°è£…

## ğŸ“ æä¾›çš„æ–‡ä»¶

1. **`excel_mcp_client.py`** - å®Œæ•´çš„ Python å®¢æˆ·ç«¯å®ç°
2. **`curl_example.sh`** - å®Œæ•´çš„ curl è°ƒç”¨ç¤ºä¾‹è„šæœ¬
3. **`full_mcp_test.py`** - åè®®æµç¨‹æµ‹è¯•è„šæœ¬

## ğŸ”§ å¯ç”¨çš„å·¥å…·æ–¹æ³•

Excel MCP Server æä¾›äº† 25 ä¸ªå·¥å…·ï¼Œä¸»è¦åŒ…æ‹¬ï¼š

### æ•°æ®æ“ä½œ

- `read_data_from_excel` - è¯»å– Excel æ•°æ®
- `write_data_to_excel` - å†™å…¥ Excel æ•°æ®

### å·¥ä½œç°¿æ“ä½œ

- `create_workbook` - åˆ›å»ºæ–°å·¥ä½œç°¿
- `get_workbook_metadata` - è·å–å·¥ä½œç°¿å…ƒæ•°æ®

### å·¥ä½œè¡¨æ“ä½œ

- `create_worksheet` - åˆ›å»ºå·¥ä½œè¡¨
- `copy_worksheet` - å¤åˆ¶å·¥ä½œè¡¨
- `delete_worksheet` - åˆ é™¤å·¥ä½œè¡¨
- `rename_worksheet` - é‡å‘½åå·¥ä½œè¡¨

### æ ¼å¼åŒ–æ“ä½œ

- `format_range` - æ ¼å¼åŒ–å•å…ƒæ ¼èŒƒå›´
- `merge_cells` - åˆå¹¶å•å…ƒæ ¼
- `unmerge_cells` - å–æ¶ˆåˆå¹¶å•å…ƒæ ¼

### å…¬å¼æ“ä½œ

- `apply_formula` - åº”ç”¨ Excel å…¬å¼
- `validate_formula_syntax` - éªŒè¯å…¬å¼è¯­æ³•

### å›¾è¡¨å’Œé€è§†è¡¨

- `create_chart` - åˆ›å»ºå›¾è¡¨
- `create_pivot_table` - åˆ›å»ºé€è§†è¡¨
- `create_table` - åˆ›å»º Excel è¡¨æ ¼

## ğŸš€ å¿«é€Ÿå¼€å§‹

1. **å¯åŠ¨æœåŠ¡å™¨**ï¼š

   ```bash
   uvx excel-mcp-server streamable-http
   ```

2. **ä½¿ç”¨ Python å®¢æˆ·ç«¯**ï¼š

   ```bash
   python excel_mcp_client.py
   ```

3. **ä½¿ç”¨ curl è„šæœ¬**ï¼š

   ```bash
   ./curl_example.sh
   ```

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **æ–‡ä»¶è·¯å¾„**ï¼šåœ¨ streamable-http æ¨¡å¼ä¸‹ï¼Œå¿…é¡»ä½¿ç”¨ç»å¯¹è·¯å¾„
2. **ä¼šè¯ç®¡ç†**ï¼šæ¯æ¬¡è°ƒç”¨éƒ½éœ€è¦æºå¸¦æ­£ç¡®çš„ session ID
3. **å“åº”æ ¼å¼**ï¼šæœåŠ¡å™¨è¿”å› SSE æ ¼å¼çš„å“åº”ï¼Œéœ€è¦æ­£ç¡®è§£æ
4. **é”™è¯¯å¤„ç†**ï¼šæ³¨æ„æ£€æŸ¥ JSON-RPC å“åº”ä¸­çš„é”™è¯¯å­—æ®µ

## ğŸ“Š ç¤ºä¾‹è¾“å‡º

æˆåŠŸè°ƒç”¨åï¼Œæ‚¨å°†è·å¾—å¦‚ä¸‹æ ¼å¼çš„ Excel æ•°æ®ï¼š

```json
{
  "range": "A1:B4",
  "sheet_name": "Sheet",
  "cells": [
    {
      "address": "A1",
      "value": "Name",
      "row": 1,
      "column": 1,
      "validation": {
        "has_validation": false
      }
    },
    // ... æ›´å¤šå•å…ƒæ ¼æ•°æ®
  ]
}
```

ç°åœ¨æ‚¨å·²ç»æœ‰äº†å®Œæ•´çš„è§£å†³æ–¹æ¡ˆæ¥æ­£ç¡®è°ƒç”¨ Excel MCP Serverï¼
